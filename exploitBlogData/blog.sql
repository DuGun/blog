/*
 Navicat Premium Data Transfer

 Source Server         : 服务器
 Source Server Type    : MySQL
 Source Server Version : 50725
 Source Host           : 47.107.76.81:3306
 Source Schema         : blog

 Target Server Type    : MySQL
 Target Server Version : 50725
 File Encoding         : 65001

 Date: 24/08/2019 17:24:07
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for article
-- ----------------------------
DROP TABLE IF EXISTS `article`;
CREATE TABLE `article` (
  `id` bigint(20) unsigned NOT NULL COMMENT '文章ID',
  `classify_id` bigint(20) unsigned DEFAULT '0' COMMENT '所属分类',
  `title` char(40) NOT NULL COMMENT '标题',
  `content_url` varchar(170) NOT NULL COMMENT '正文路径',
  `time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '发布时间',
  `status` int(11) unsigned DEFAULT '0' COMMENT '状态(0-待定、1-发布、2-私人）',
  `thumbnail_url` varchar(170) DEFAULT NULL COMMENT '缩略图',
  PRIMARY KEY (`id`),
  UNIQUE KEY `content_url` (`content_url`),
  KEY `classify_id` (`classify_id`),
  CONSTRAINT `article_ibfk_1` FOREIGN KEY (`classify_id`) REFERENCES `classify` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of article
-- ----------------------------
BEGIN;
INSERT INTO `article` VALUES (1, 0, '2', '1', '2019-08-24 17:10:06', 0, NULL);
COMMIT;

-- ----------------------------
-- Table structure for article_subfunction
-- ----------------------------
DROP TABLE IF EXISTS `article_subfunction`;
CREATE TABLE `article_subfunction` (
  `article_id` bigint(20) unsigned NOT NULL COMMENT '文章id',
  `read_sum` int(11) DEFAULT '0' COMMENT '阅读数',
  `comments_sum` int(11) DEFAULT '0' COMMENT '评论量',
  `good` int(11) DEFAULT '0' COMMENT '点赞',
  PRIMARY KEY (`article_id`),
  CONSTRAINT `article_subfunction_ibfk_1` FOREIGN KEY (`article_id`) REFERENCES `article` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for background
-- ----------------------------
DROP TABLE IF EXISTS `background`;
CREATE TABLE `background` (
  `id` bigint(20) unsigned NOT NULL,
  `url` varchar(170) NOT NULL COMMENT '路径',
  `time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `url` (`url`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for blggger
-- ----------------------------
DROP TABLE IF EXISTS `blggger`;
CREATE TABLE `blggger` (
  `password` varchar(255) NOT NULL COMMENT '密码',
  `bogger_name` char(15) NOT NULL COMMENT '博客名',
  `head` varchar(170) NOT NULL COMMENT '头像',
  `contact` varchar(100) DEFAULT NULL COMMENT '联系方式'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for blogger_layout
-- ----------------------------
DROP TABLE IF EXISTS `blogger_layout`;
CREATE TABLE `blogger_layout` (
  `table_name` char(40) NOT NULL COMMENT '固定内容表名',
  `fiexd_content_id` bigint(20) unsigned NOT NULL COMMENT '固定内容ID',
  `fiexd_rank` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '固定级别：0为单一固定，1-9为顺序',
  `fiexd_place` bigint(20) unsigned NOT NULL COMMENT '固定地点 例如文章在某分类',
  PRIMARY KEY (`fiexd_rank`,`fiexd_place`),
  KEY `blogger_layout_ibfk_1` (`fiexd_place`),
  CONSTRAINT `blogger_layout_ibfk_1` FOREIGN KEY (`fiexd_place`) REFERENCES `fixed_location` (`fixed_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for classify
-- ----------------------------
DROP TABLE IF EXISTS `classify`;
CREATE TABLE `classify` (
  `id` bigint(20) unsigned NOT NULL COMMENT '文章分类',
  `article_sum` int(11) unsigned DEFAULT '0' COMMENT '文章数量',
  `read_sun` int(11) unsigned DEFAULT '0' COMMENT '阅读数',
  `comments_sun` int(11) unsigned DEFAULT '0' COMMENT '评论数',
  `classify_name` char(40) NOT NULL COMMENT '分类名称',
  PRIMARY KEY (`id`),
  UNIQUE KEY `classify_name` (`classify_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of classify
-- ----------------------------
BEGIN;
INSERT INTO `classify` VALUES (0, 0, 0, 0, '不分类');
COMMIT;

-- ----------------------------
-- Table structure for comments
-- ----------------------------
DROP TABLE IF EXISTS `comments`;
CREATE TABLE `comments` (
  `id` bigint(20) unsigned NOT NULL COMMENT '评论ID',
  `article_id` bigint(20) unsigned NOT NULL COMMENT '文章ID',
  `content` mediumtext NOT NULL COMMENT '评论内容',
  `time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '评论时间',
  `user_name` char(40) NOT NULL COMMENT '评论昵称',
  `email` char(40) NOT NULL COMMENT '评论人邮箱',
  `reply` mediumtext COMMENT '回复',
  PRIMARY KEY (`id`),
  KEY `article_id` (`article_id`),
  CONSTRAINT `comments_ibfk_1` FOREIGN KEY (`article_id`) REFERENCES `article` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for fixed_location
-- ----------------------------
DROP TABLE IF EXISTS `fixed_location`;
CREATE TABLE `fixed_location` (
  `fixed_id` bigint(20) unsigned NOT NULL COMMENT '定位id',
  `fixed_name` char(40) NOT NULL COMMENT '代号',
  PRIMARY KEY (`fixed_id`,`fixed_name`),
  KEY `fixed_id` (`fixed_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for subscription
-- ----------------------------
DROP TABLE IF EXISTS `subscription`;
CREATE TABLE `subscription` (
  `email` char(40) NOT NULL COMMENT '订阅人邮箱',
  `classify_id` bigint(20) unsigned NOT NULL COMMENT '文章分类ID',
  PRIMARY KEY (`email`,`classify_id`),
  KEY `classify_id` (`classify_id`),
  CONSTRAINT `subscription_ibfk_1` FOREIGN KEY (`classify_id`) REFERENCES `classify` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for user
-- ----------------------------
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user` (
  `head` varchar(170) DEFAULT NULL COMMENT '头像',
  `email` char(40) NOT NULL COMMENT '邮箱',
  `user_name` char(40) DEFAULT NULL COMMENT '昵称',
  `good_sun` int(11) unsigned DEFAULT '0' COMMENT '点赞次数',
  `comments_sum` int(11) unsigned DEFAULT '0' COMMENT '评论次数',
  `address` varchar(255) DEFAULT NULL COMMENT '地点@地点@地点',
  PRIMARY KEY (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for words
-- ----------------------------
DROP TABLE IF EXISTS `words`;
CREATE TABLE `words` (
  `id` bigint(20) unsigned NOT NULL,
  `content` varchar(255) DEFAULT NULL COMMENT '内容',
  `time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

SET FOREIGN_KEY_CHECKS = 1;
